{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file:///Users/tian/Codes/sspai_tracker/components/StatsChart.jsx"],"sourcesContent":["import { Line } from 'react-chartjs-2';\nimport {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend,\n} from 'chart.js';\nimport dayjs from 'dayjs';\n\nChartJS.register(\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n);\n\nexport default function StatsChart({ history, title = 'Trend', dataKey = 'views', color = 'rgb(217, 48, 37)' }) {\n    const sortedHistory = [...history].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n\n    const data = {\n        labels: sortedHistory.map(h => dayjs(h.timestamp).format('MM-DD HH:mm')),\n        datasets: [\n            {\n                label: title,\n                data: sortedHistory.map(h => {\n                    // If h has 'totals' (it's a daily snapshot), look in totals or articles\n                    // If dataKey suggests looking into a specific article, the history passed here should already be \"article history\" (flat objects)\n                    // or \"global history\".\n                    // Let's assume the parent prepares the data correctly: an array of objects { timestamp, [dataKey]: value }\n                    return h[dataKey] !== undefined ? h[dataKey] : 0;\n                }),\n                borderColor: color,\n                backgroundColor: color.replace('rgb', 'rgba').replace(')', ', 0.5)'),\n                tension: 0.3,\n                pointRadius: 3,\n                pointHoverRadius: 5\n            },\n        ],\n    };\n\n    const options = {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n            legend: { display: false },\n            title: { display: false },\n            tooltip: {\n                mode: 'index',\n                intersect: false,\n                backgroundColor: 'rgba(0,0,0,0.8)',\n                titleFont: { size: 13 },\n                bodyFont: { size: 13 },\n                padding: 10,\n                cornerRadius: 8,\n                displayColors: false\n            }\n        },\n        scales: {\n            x: {\n                grid: { display: false },\n                ticks: { maxTicksLimit: 8, color: '#86868B', font: { size: 11 } }\n            },\n            y: {\n                border: { display: false },\n                grid: { color: 'rgba(0,0,0,0.05)' },\n                ticks: { color: '#86868B', font: { size: 11 } },\n                beginAtZero: false\n            }\n        },\n        interaction: {\n            mode: 'nearest',\n            axis: 'x',\n            intersect: false\n        }\n    };\n\n    return <div style={{ height: '300px' }}><Line options={options} data={data} /></div>;\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAUA;;;;;;;;;;AAEA,iLAAO,CAAC,QAAQ,CACZ,yLAAa,EACb,uLAAW,EACX,wLAAY,EACZ,uLAAW,EACX,iLAAK,EACL,mLAAO,EACP,kLAAM;AAGK,SAAS,WAAW,EAAE,OAAO,EAAE,QAAQ,OAAO,EAAE,UAAU,OAAO,EAAE,QAAQ,kBAAkB,EAAE;IAC1G,MAAM,gBAAgB;WAAI;KAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,IAAI,IAAI,KAAK,EAAE,SAAS;IAE9F,MAAM,OAAO;QACT,QAAQ,cAAc,GAAG,CAAC,CAAA,IAAK,IAAA,0JAAK,EAAC,EAAE,SAAS,EAAE,MAAM,CAAC;QACzD,UAAU;YACN;gBACI,OAAO;gBACP,MAAM,cAAc,GAAG,CAAC,CAAA;oBACpB,wEAAwE;oBACxE,kIAAkI;oBAClI,uBAAuB;oBACvB,2GAA2G;oBAC3G,OAAO,CAAC,CAAC,QAAQ,KAAK,YAAY,CAAC,CAAC,QAAQ,GAAG;gBACnD;gBACA,aAAa;gBACb,iBAAiB,MAAM,OAAO,CAAC,OAAO,QAAQ,OAAO,CAAC,KAAK;gBAC3D,SAAS;gBACT,aAAa;gBACb,kBAAkB;YACtB;SACH;IACL;IAEA,MAAM,UAAU;QACZ,YAAY;QACZ,qBAAqB;QACrB,SAAS;YACL,QAAQ;gBAAE,SAAS;YAAM;YACzB,OAAO;gBAAE,SAAS;YAAM;YACxB,SAAS;gBACL,MAAM;gBACN,WAAW;gBACX,iBAAiB;gBACjB,WAAW;oBAAE,MAAM;gBAAG;gBACtB,UAAU;oBAAE,MAAM;gBAAG;gBACrB,SAAS;gBACT,cAAc;gBACd,eAAe;YACnB;QACJ;QACA,QAAQ;YACJ,GAAG;gBACC,MAAM;oBAAE,SAAS;gBAAM;gBACvB,OAAO;oBAAE,eAAe;oBAAG,OAAO;oBAAW,MAAM;wBAAE,MAAM;oBAAG;gBAAE;YACpE;YACA,GAAG;gBACC,QAAQ;oBAAE,SAAS;gBAAM;gBACzB,MAAM;oBAAE,OAAO;gBAAmB;gBAClC,OAAO;oBAAE,OAAO;oBAAW,MAAM;wBAAE,MAAM;oBAAG;gBAAE;gBAC9C,aAAa;YACjB;QACJ;QACA,aAAa;YACT,MAAM;YACN,MAAM;YACN,WAAW;QACf;IACJ;IAEA,qBAAO,qKAAC;QAAI,OAAO;YAAE,QAAQ;QAAQ;kBAAG,cAAA,qKAAC,8MAAI;YAAC,SAAS;YAAS,MAAM;;;;;;;;;;;AAC1E"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/tian/Codes/sspai_tracker/pages/index.jsx"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport StatsChart from '../components/StatsChart';\nimport dayjs from 'dayjs';\n\nexport default function Home({ history, latest, latestTimestamp }) {\n    // latest.totals holds the aggregate\n    // latest.articles holds the array of articles\n\n    const totals = latest.totals || latest; // Fallback for old format if any\n\n    return (\n        <div className=\"min-h-screen\">\n            <Head>\n                <title>SSPAI Tracker</title>\n                <link rel=\"icon\" href=\"/favicon.ico\" />\n            </Head>\n\n            <main className=\"container\">\n                <header>\n                    <div>\n                        <h1>SSPAI Tracker</h1>\n                        <p className=\"subtitle\">\n                            Tracking <strong className=\"text-primary\">{totals.article_count || 0}</strong> articles.\n                            Last updated: {dayjs(latestTimestamp).format('YYYY-MM-DD HH:mm')}\n                        </p>\n                    </div>\n                    <a href=\"https://github.com/Hessel2333/sspai_tracking\" target=\"_blank\" className=\"article-link\" style={{ fontSize: 14 }}>\n                        GitHub â†—\n                    </a>\n                </header>\n\n                {/* --- Summary Cards --- */}\n                <div className=\"grid\">\n                    <Card title=\"Total Views\" value={totals.views || totals.total_views} icon=\"ðŸ‘€\" />\n                    <Card title=\"Total Likes\" value={totals.likes || totals.total_likes} icon=\"â¤ï¸\" />\n                    <Card title=\"Total Comments\" value={totals.comments || totals.total_comments} icon=\"ðŸ’¬\" />\n                </div>\n\n                {/* --- Chart --- */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"card-title\">Total Views Trend</span>\n                    </div>\n                    <div style={{ padding: 24 }}>\n                        <StatsChart history={history} title=\"Total Views\" dataKey={Object.keys(totals).includes('views') ? 'totals.views' : 'total_views'} />\n                    </div>\n                </div>\n\n                {/* --- Article List --- */}\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <h2>Tracked Articles</h2>\n                    </div>\n                    {latest.articles && latest.articles.length > 0 ? (\n                        <div style={{ overflowX: 'auto' }}>\n                            <table>\n                                <thead>\n                                    <tr>\n                                        <th>Title</th>\n                                        <th className=\"text-right\">Views</th>\n                                        <th className=\"text-right\">Likes</th>\n                                        <th className=\"text-right\">Comments</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {latest.articles.sort((a, b) => b.views - a.views).map(article => (\n                                        <tr key={article.id}>\n                                            <td>\n                                                <Link href={`/post/${article.id}`} className=\"article-link\">\n                                                    {article.title}\n                                                </Link>\n                                                <span className=\"meta-text\">{dayjs.unix(article.created_at).format('YYYY-MM-DD')}</span>\n                                            </td>\n                                            <td className=\"stat-cell\">{article.views.toLocaleString()}</td>\n                                            <td className=\"stat-cell\">{article.likes.toLocaleString()}</td>\n                                            <td className=\"stat-cell\">{article.comments.toLocaleString()}</td>\n                                        </tr>\n                                    ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    ) : (\n                        <div style={{ padding: 24, textAlign: 'center', color: '#999' }}>No article details available yet.</div>\n                    )}\n                </div>\n            </main>\n        </div>\n    );\n}\n\nfunction Card({ title, value, icon }) {\n    return (\n        <div className=\"card\">\n            <div className=\"card-content\">\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                    <span className=\"card-title\">{title}</span>\n                    <span style={{ fontSize: 20 }}>{icon}</span>\n                </div>\n                <p className=\"card-value\">{value ? value.toLocaleString() : 0}</p>\n            </div>\n        </div>\n    );\n}\n\nexport async function getStaticProps() {\n    const dataDir = path.join(process.cwd(), 'data');\n    const historyPath = path.join(dataDir, 'history.json');\n\n    // Read history file at build time\n    let history = [];\n    try {\n        const fileContent = fs.readFileSync(historyPath, 'utf8');\n        history = JSON.parse(fileContent);\n    } catch (e) {\n        console.error('Error reading history file:', e);\n    }\n\n    const latest = history.length > 0 ? history[history.length - 1] : {};\n\n    return {\n        props: {\n            history,\n            latest,\n            latestTimestamp: latest.timestamp || null,\n        },\n        // Add revalidate if you want ISR, but for this git-trigger model, simple SSG is fine.\n    };\n}\n"],"names":[],"mappings":"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"}}]
}