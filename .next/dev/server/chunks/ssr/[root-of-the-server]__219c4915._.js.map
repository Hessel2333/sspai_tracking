{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file:///Users/tian/Codes/sspai_tracker/components/StatsChart.jsx"],"sourcesContent":["import { Line } from 'react-chartjs-2';\nimport {\n    Chart as ChartJS,\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend,\n} from 'chart.js';\nimport dayjs from 'dayjs';\n\nChartJS.register(\n    CategoryScale,\n    LinearScale,\n    PointElement,\n    LineElement,\n    Title,\n    Tooltip,\n    Legend\n);\n\nexport default function StatsChart({ history, title = 'Trend', dataKey = 'views', color = 'rgb(217, 48, 37)' }) {\n    const sortedHistory = [...history].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));\n\n    const data = {\n        labels: sortedHistory.map(h => dayjs(h.timestamp).format('MM-DD HH:mm')),\n        datasets: [\n            {\n                label: title,\n                data: sortedHistory.map(h => {\n                    // If h has 'totals' (it's a daily snapshot), look in totals or articles\n                    // If dataKey suggests looking into a specific article, the history passed here should already be \"article history\" (flat objects)\n                    // or \"global history\".\n                    // Let's assume the parent prepares the data correctly: an array of objects { timestamp, [dataKey]: value }\n                    return h[dataKey] !== undefined ? h[dataKey] : 0;\n                }),\n                borderColor: color,\n                backgroundColor: color.replace('rgb', 'rgba').replace(')', ', 0.5)'),\n                tension: 0.3,\n                pointRadius: 3,\n                pointHoverRadius: 5\n            },\n        ],\n    };\n\n    const options = {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n            legend: { display: false },\n            title: { display: false },\n            tooltip: {\n                mode: 'index',\n                intersect: false,\n                backgroundColor: 'rgba(0,0,0,0.8)',\n                titleFont: { size: 13 },\n                bodyFont: { size: 13 },\n                padding: 10,\n                cornerRadius: 8,\n                displayColors: false\n            }\n        },\n        scales: {\n            x: {\n                grid: { display: false },\n                ticks: { maxTicksLimit: 8, color: '#86868B', font: { size: 11 } }\n            },\n            y: {\n                border: { display: false },\n                grid: { color: 'rgba(0,0,0,0.05)' },\n                ticks: { color: '#86868B', font: { size: 11 } },\n                beginAtZero: false\n            }\n        },\n        interaction: {\n            mode: 'nearest',\n            axis: 'x',\n            intersect: false\n        }\n    };\n\n    return <div style={{ height: '300px' }}><Line options={options} data={data} /></div>;\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAUA;;;;;;;;;;AAEA,iLAAO,CAAC,QAAQ,CACZ,yLAAa,EACb,uLAAW,EACX,wLAAY,EACZ,uLAAW,EACX,iLAAK,EACL,mLAAO,EACP,kLAAM;AAGK,SAAS,WAAW,EAAE,OAAO,EAAE,QAAQ,OAAO,EAAE,UAAU,OAAO,EAAE,QAAQ,kBAAkB,EAAE;IAC1G,MAAM,gBAAgB;WAAI;KAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,IAAI,KAAK,EAAE,SAAS,IAAI,IAAI,KAAK,EAAE,SAAS;IAE9F,MAAM,OAAO;QACT,QAAQ,cAAc,GAAG,CAAC,CAAA,IAAK,IAAA,0JAAK,EAAC,EAAE,SAAS,EAAE,MAAM,CAAC;QACzD,UAAU;YACN;gBACI,OAAO;gBACP,MAAM,cAAc,GAAG,CAAC,CAAA;oBACpB,wEAAwE;oBACxE,kIAAkI;oBAClI,uBAAuB;oBACvB,2GAA2G;oBAC3G,OAAO,CAAC,CAAC,QAAQ,KAAK,YAAY,CAAC,CAAC,QAAQ,GAAG;gBACnD;gBACA,aAAa;gBACb,iBAAiB,MAAM,OAAO,CAAC,OAAO,QAAQ,OAAO,CAAC,KAAK;gBAC3D,SAAS;gBACT,aAAa;gBACb,kBAAkB;YACtB;SACH;IACL;IAEA,MAAM,UAAU;QACZ,YAAY;QACZ,qBAAqB;QACrB,SAAS;YACL,QAAQ;gBAAE,SAAS;YAAM;YACzB,OAAO;gBAAE,SAAS;YAAM;YACxB,SAAS;gBACL,MAAM;gBACN,WAAW;gBACX,iBAAiB;gBACjB,WAAW;oBAAE,MAAM;gBAAG;gBACtB,UAAU;oBAAE,MAAM;gBAAG;gBACrB,SAAS;gBACT,cAAc;gBACd,eAAe;YACnB;QACJ;QACA,QAAQ;YACJ,GAAG;gBACC,MAAM;oBAAE,SAAS;gBAAM;gBACvB,OAAO;oBAAE,eAAe;oBAAG,OAAO;oBAAW,MAAM;wBAAE,MAAM;oBAAG;gBAAE;YACpE;YACA,GAAG;gBACC,QAAQ;oBAAE,SAAS;gBAAM;gBACzB,MAAM;oBAAE,OAAO;gBAAmB;gBAClC,OAAO;oBAAE,OAAO;oBAAW,MAAM;wBAAE,MAAM;oBAAG;gBAAE;gBAC9C,aAAa;YACjB;QACJ;QACA,aAAa;YACT,MAAM;YACN,MAAM;YACN,WAAW;QACf;IACJ;IAEA,qBAAO,qKAAC;QAAI,OAAO;YAAE,QAAQ;QAAQ;kBAAG,cAAA,qKAAC,8MAAI;YAAC,SAAS;YAAS,MAAM;;;;;;;;;;;AAC1E"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/tian/Codes/sspai_tracker/pages/post/%5Bid%5D.jsx"],"sourcesContent":["import fs from 'fs';\nimport path from 'path';\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport StatsChart from '../../components/StatsChart';\nimport dayjs from 'dayjs';\n\nexport default function ArticleDetail({ article, history, latestTimestamp }) {\n    if (!article) return <div className=\"container\" style={{ padding: 40 }}>Article not found.</div>;\n\n    return (\n        <div className=\"min-h-screen bg-gray-50\">\n            <Head>\n                <title>{article.title} - SSPAI Tracker</title>\n            </Head>\n\n            <main className=\"container\">\n                <div style={{ marginTop: 40, marginBottom: 20 }}>\n                    <Link href=\"/\" className=\"back-link\">\n                        ‚Üê Back to Dashboard\n                    </Link>\n                </div>\n\n                <header>\n                    <div>\n                        <span className=\"badge\">Article Analysis</span>\n                        <h1 style={{ marginTop: 12 }}>{article.title}</h1>\n                        <p className=\"subtitle\">\n                            ID: {article.id} ‚Ä¢ Published: {dayjs.unix(article.created_at).format('YYYY-MM-DD')} ‚Ä¢ Last Updated: {dayjs(latestTimestamp).format('HH:mm')}\n                        </p>\n                    </div>\n                    <a href={`https://sspai.com/post/${article.id}`} target=\"_blank\" className=\"article-link text-accent\">\n                        View on SSPAI ‚Üó\n                    </a>\n                </header>\n\n                {/* --- Key Metrics --- */}\n                <div className=\"grid\">\n                    <Card title=\"Total Views\" value={article.views} icon=\"üëÄ\" />\n                    <Card title=\"Total Likes\" value={article.likes} icon=\"‚ù§Ô∏è\" />\n                    <Card title=\"Total Comments\" value={article.comments} icon=\"üí¨\" />\n                </div>\n\n                {/* --- Charts --- */}\n                <h2 style={{ marginBottom: 16 }}>Growth Trends</h2>\n\n                <div className=\"section\">\n                    <div className=\"section-header\">\n                        <span className=\"card-title\">Views Growth</span>\n                        <span className=\"meta-text\">{history.length} data points</span>\n                    </div>\n                    <div style={{ padding: 24 }}>\n                        <StatsChart history={history} title=\"Views\" dataKey=\"views\" color=\"rgb(217, 48, 37)\" />\n                    </div>\n                </div>\n\n                <div className=\"grid\" style={{ gridTemplateColumns: '1fr 1fr', marginBottom: 40 }}>\n                    <div className=\"section\" style={{ marginBottom: 0 }}>\n                        <div className=\"section-header\">\n                            <span className=\"card-title\">Likes Growth</span>\n                        </div>\n                        <div style={{ padding: 24 }}>\n                            <StatsChart history={history} title=\"Likes\" dataKey=\"likes\" color=\"rgb(52, 199, 89)\" />\n                        </div>\n                    </div>\n                    <div className=\"section\" style={{ marginBottom: 0 }}>\n                        <div className=\"section-header\">\n                            <span className=\"card-title\">Comments Growth</span>\n                        </div>\n                        <div style={{ padding: 24 }}>\n                            <StatsChart history={history} title=\"Comments\" dataKey=\"comments\" color=\"rgb(0, 122, 255)\" />\n                        </div>\n                    </div>\n                </div>\n\n            </main>\n        </div>\n    );\n}\n\nfunction Card({ title, value, icon }) {\n    return (\n        <div className=\"card\">\n            <div className=\"card-content\">\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                    <span className=\"card-title\">{title}</span>\n                    <span style={{ fontSize: 20 }}>{icon}</span>\n                </div>\n                <p className=\"card-value\">{value ? value.toLocaleString() : 0}</p>\n            </div>\n        </div>\n    );\n}\n\nexport async function getStaticPaths() {\n    const dataDir = path.join(process.cwd(), 'data');\n    const historyPath = path.join(dataDir, 'history.json');\n    let history = [];\n    try {\n        history = JSON.parse(fs.readFileSync(historyPath, 'utf8'));\n    } catch (e) { }\n\n    // Get all unique article IDs from the LATEST snapshot (assuming it contains all)\n    const latest = history.length > 0 ? history[history.length - 1] : { articles: [] };\n    const paths = (latest.articles || []).map(article => ({\n        params: { id: article.id.toString() }\n    }));\n\n    return { paths, fallback: 'blocking' };\n}\n\nexport async function getStaticProps({ params }) {\n    const dataDir = path.join(process.cwd(), 'data');\n    const historyPath = path.join(dataDir, 'history.json');\n    let history = [];\n    try {\n        history = JSON.parse(fs.readFileSync(historyPath, 'utf8'));\n    } catch (e) { }\n\n    const articleId = parseInt(params.id);\n\n    // 1. Find latest metadata for this article\n    const latestSnapshot = history.length > 0 ? history[history.length - 1] : {};\n    const article = (latestSnapshot.articles || []).find(a => a.id === articleId) || null;\n\n    // 2. Build history for this specific article\n    // We iterate through ALL history snapshots and extract data for this articleId\n    const articleHistory = history.map(snapshot => {\n        const art = (snapshot.articles || []).find(a => a.id === articleId);\n        if (art) {\n            return {\n                timestamp: snapshot.timestamp,\n                views: art.views,\n                likes: art.likes,\n                comments: art.comments\n            };\n        }\n        return null;\n    }).filter(item => item !== null);\n\n    return {\n        props: {\n            article,\n            history: articleHistory,\n            latestTimestamp: latestSnapshot.timestamp || null\n        }\n    };\n}\n"],"names":[],"mappings":"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"}}]
}